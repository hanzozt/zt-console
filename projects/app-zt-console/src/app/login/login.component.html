<div class="login-page" (keyup.enter)="next()">
  <div class="splash-page-wrapper">
    <div class="splash-page-container" *ngIf="!showAddController && !showAdminLogin">
      <div class="zt-logo-container">
        <img src="/assets/svgs/hanzo-logo-white.svg" class="hanzo-logo" alt="Hanzo">
      </div>
      <div class="zt-title">Zero Trust Console</div>
      <div class="zt-subtitle">Secure network management by Hanzo</div>

      <div class="login-actions" *ngIf="!showNoControllers">
        <div class="idp-buttons-container" *ngIf="extJwtSigners && extJwtSigners.length > 0">
          <button class="hanzo-login-button"
               *ngFor="let jwtSigner of extJwtSigners"
               (click)="handleOAuthLogin(jwtSigner)">
            Login with Hanzo
            <div class="spinner" *ngIf="oauthLoading === jwtSigner.name"></div>
          </button>
        </div>
        <div class="admin-link" (click)="showAdminLogin = true">Admin Login</div>
      </div>

      <div *ngIf="showNoControllers" class="no-controllers-warning">
        <span class="warning-title">Connecting to controller...</span>
        <span class="warning-detail">Waiting for ZT controller at zt-api.hanzo.ai</span>
      </div>

      <span *ngIf="errors['loginFailed']" class="error-message">{{errors['loginFailed']}}</span>
    </div>

    <!-- Admin username/password login (hidden by default) -->
    <div class="splash-page-container admin-panel" *ngIf="!showAddController && showAdminLogin">
      <div class="zt-logo-container">
        <img src="/assets/svgs/hanzo-logo-white.svg" class="hanzo-logo hanzo-logo-small" alt="Hanzo">
      </div>
      <div class="zt-title zt-title-small">Admin Login</div>

      <lib-selector-input
        *ngIf="!svc.originIsController && !showNoControllers"
        [fieldName]="'Controller'"
        [(fieldValue)]="selectedEdgeController"
        [error]="edgeNameError"
        [placeholder]="controllerSelectPlaceholder"
        [valueList]="edgeControllerList"
        [helpText]="helpText"
        [fieldClass]="controllerInvalid ? 'invalid' : ''"
        (fieldValueChange)="edgeChanged($event)"
      ></lib-selector-input>

      <div class="username-pass-container">
        <div class="input-fields-container">
          <label for="Username" class="field-label">Username</label>
          <input id="Username" name="username" type="text" autocomplete="on" required
            [placeholder]="'Username'" (change)="usernameChange($event)" (keyup)="usernameChange($event)">
        </div>
        <div class="input-fields-container">
          <label for="Password" class="field-label">Password</label>
          <input id="Password" name="password" type="password" autocomplete="on" required
            [placeholder]="'Password'" (change)="passwordChange($event)" (keyup)="passwordChange($event)">
        </div>
      </div>

      <span *ngIf="errors['loginFailed']" class="error-message">{{errors['loginFailed']}}</span>

      <div class="buttons-container">
        <button class="admin-login-button" (click)="login()">Log In</button>
      </div>
      <div class="admin-link" (click)="showAdminLogin = false">Back</div>
    </div>

    <!-- Add controller panel -->
    <div class="splash-page-container" *ngIf="showAddController">
      <div class="zt-logo-container">
        <img src="/assets/svgs/hanzo-logo-white.svg" class="hanzo-logo hanzo-logo-small" alt="Hanzo">
      </div>
      <div class="zt-title zt-title-small">Add Controller</div>
      <div class="username-pass-container">
        <lib-string-input [fieldName]="'Controller Name'" [(fieldValue)]="edgeName" [error]="edgeNameError" [placeholder]="'enter a name'"></lib-string-input>
        <lib-string-input [fieldName]="'URL'" [(fieldValue)]="edgeUrl" [error]="edgeUrlError" [placeholder]="'e.g. https://zt-api.hanzo.ai:443'" [helpText]="helpText" [fieldClass]="controllerInvalid ? 'invalid' : ''"></lib-string-input>
      </div>
      <div class="buttons-container">
        <button class="admin-login-button" (click)="create()" [disabled]="!edgeName || !edgeUrl">Set Controller</button>
      </div>
      <div *ngIf="edgeControllerList.length > 0" class="admin-link" (click)="reset()">Back</div>
    </div>
  </div>
</div>
<lib-loading-indicator [isLoading]="isLoading || extJwtSignersLoading"></lib-loading-indicator>
